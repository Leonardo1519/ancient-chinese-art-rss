<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>设计视界 · 思政融新</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="page">
      <header class="topbar">
        <div class="brand">
          <img src="../icons/icon48.png" alt="logo" class="brand-logo" />
          <div>
            <div class="title">设计视界 · 思政融新</div>
            <div class="subtitle">一站式整合国内外最新设计资讯，以思想之光引领设计创新。</div>
          </div>
        </div>
      </header>

      <section class="filters">
        <div class="filters-left">
          <select id="source-filter" class="input select"></select>
          <label class="checkbox">
            <input type="checkbox" id="unread-only" />
            <span>仅未读</span>
          </label>
          <input
            type="search"
            id="search-input"
            class="input search-input"
            placeholder="搜索标题或来源..."
          />
        </div>
        <div class="filters-actions">
          <button id="refresh-btn" class="btn ghost">刷新</button>
          <span id="last-updated" class="meta">最近更新：--</span>
        </div>
      </section>

      <main class="content">
        <section id="view-home" class="view active">
          <div id="news-list" class="card-grid"></div>
          <div id="empty-home" class="empty hidden">暂无资讯，尝试刷新或添加新源</div>
        </section>

        <section id="view-favorites" class="view">
          <div class="favorites-panel">
            <div class="favorites-toolbar">
              <select id="favorite-source-filter" class="input select">
                <option value="all">全部来源</option>
              </select>
              <select id="favorite-tag-filter" class="input select">
                <option value="all">全部标签</option>
              </select>
              <label class="checkbox favorites-checkbox">
                <input type="checkbox" id="favorite-unread-only" />
                <span>仅未读</span>
              </label>
              <input
                type="search"
                id="favorite-search"
                class="input search-input"
                placeholder="搜索收藏标题、来源或摘要..."
              />
            </div>
            <div id="favorite-result-count" class="favorites-count"></div>
            <div id="favorite-list" class="card-grid"></div>
            <div id="empty-fav" class="empty hidden">暂无收藏内容</div>
          </div>
        </section>

        <section id="view-sources" class="view">
          <div class="sources-panels">
            <div class="panel">
              <div class="panel-header">
                <div>
                  <div class="panel-title">RSS 源管理</div>
                  <div class="panel-subtitle">
                    预置源已添加，可自由增删并可自动探测 RSS 链接
                  </div>
                </div>
              </div>
              <div id="source-list" class="source-list"></div>
            </div>

            <div class="panel">
              <div class="panel-header">
                <div>
                  <div class="panel-title">添加自定义源</div>
                  <div class="panel-subtitle">填写后保存，即可参与统一更新</div>
                </div>
              </div>
              <form id="add-source-form" class="form">
                <input
                  name="name"
                  class="input"
                  placeholder="源名称（必填）"
                  required
                />
                <input
                  name="feedUrl"
                  class="input"
                  placeholder="RSS 链接（必填）"
                  required
                />
                <input
                  name="pageUrl"
                  class="input"
                  placeholder="源主页（可选）"
                />
                <p class="input-hint">
                  源主页是该 RSS 提供方的官网/主页 URL，可辅助探测 RSS，若 RSS 链接丢失或变动，将利用源主页生成可点击的阅读链接，建议填写。
                </p>
                <button type="submit" class="btn primary">添加源</button>
              </form>
            </div>
          </div>
        </section>

        <section id="view-settings" class="view">
          <div class="settings-panels">
            <div class="panel">
              <div class="panel-header">
                <div class="panel-title">更新频率设置</div>
                <div class="panel-subtitle">个性化更新与通知配置</div>
              </div>
              <div class="field">
                <label for="setting-interval">更新频率（小时）</label>
                <input
                  type="number"
                  id="setting-interval"
                  class="input"
                  min="1"
                  max="24"
                />
              </div>
              <div class="field">
                <label class="checkbox">
                  <input type="checkbox" id="setting-notify" />
                  <span>有新内容时通知我</span>
                </label>
              </div>
              <div class="field">
                <label class="checkbox">
                  <input type="checkbox" id="setting-badge" />
                  <span>显示未读角标</span>
                </label>
              </div>
              <div class="field">
                <label class="checkbox">
                  <input type="checkbox" id="setting-newtab" />
                  <span>文章在新标签页打开</span>
                </label>
              </div>
              <button id="clear-data-btn" class="btn danger">重置数据</button>
            </div>
            <div class="panel">
              <div class="panel-header">
                <div class="panel-title">标签管理</div>
                <div class="panel-subtitle">
                  新建标签可用于资讯分类，在资讯或收藏卡片右键即可打标签。
                </div>
              </div>
              <div id="tag-list" class="tag-manager-list"></div>
              <form id="create-tag-form" class="tag-form">
                <input
                  id="new-tag-input"
                  class="input"
                  placeholder="输入标签名称，例如“文创”"
                  maxlength="18"
                />
                <button type="submit" class="btn primary">新建标签</button>
              </form>
            </div>
          </div>
        </section>
      </main>

      <aside id="detail-drawer" class="drawer hidden">
        <div class="drawer-header">
          <div>
            <div id="detail-title" class="drawer-title"></div>
            <div id="detail-meta" class="drawer-meta"></div>
          </div>
        </div>
        <div id="detail-content" class="drawer-content"></div>
        <a id="detail-link" class="btn link" target="_blank" rel="noreferrer">
          查看原文
        </a>
        <button id="detail-close" class="drawer-close-link" type="button">
          关闭
        </button>
      </aside>

      <nav class="bottom-nav">
        <button data-view="home" class="active">资讯</button>
        <button data-view="favorites">收藏</button>
        <button data-view="sources">RSS 源</button>
        <button data-view="settings">设置</button>
      </nav>

      <button id="back-to-top" class="back-to-top" type="button" aria-label="返回顶部">
        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M12 5.5c-.32 0-.63.13-.86.36l-6.5 6.5a1.25 1.25 0 0 0 1.77 1.77L11 8.94V18.5a1.25 1.25 0 1 0 2.5 0V8.94l4.59 4.19a1.25 1.25 0 0 0 1.77-1.77l-6.5-6.5c-.23-.23-.54-.36-.86-.36z"/>
        </svg>
      </button>

      <div id="tag-context-menu" class="tag-menu hidden">
        <div class="tag-menu-header">
          <div class="tag-menu-title">为资讯打标签</div>
          <button id="tag-menu-close" class="tag-menu-close" aria-label="关闭标签菜单">
            ×
          </button>
        </div>
        <div id="tag-menu-list" class="tag-menu-list"></div>
        <div class="tag-menu-footer">
          <button id="tag-menu-manage" class="btn ghost small">去设置页管理</button>
        </div>
      </div>

      <div
        id="edit-source-modal"
        class="modal hidden"
        role="dialog"
        aria-modal="true"
        aria-hidden="true"
        aria-labelledby="edit-source-title"
      >
        <div class="modal-dialog">
          <div class="modal-header">
            <div>
              <div id="edit-source-title" class="modal-title">编辑 RSS 源</div>
              <div class="modal-subtitle">同时更新名称与链接</div>
            </div>
            <button
              type="button"
              id="edit-source-close"
              class="modal-close"
              aria-label="关闭编辑窗口"
            >
              ×
            </button>
          </div>
          <form id="edit-source-form" class="modal-form">
            <label class="modal-label" for="edit-source-name">源名称</label>
            <input
              id="edit-source-name"
              name="name"
              class="input"
              placeholder="请输入源名称"
              required
            />
            <label class="modal-label" for="edit-source-url">RSS 链接</label>
            <input
              id="edit-source-url"
              name="feedUrl"
              class="input"
              placeholder="请输入 RSS 链接"
              required
            />
            <label class="modal-label" for="edit-source-page">源主页（可选）</label>
            <input
              id="edit-source-page"
              name="pageUrl"
              class="input"
              placeholder="用于辅助生成阅读链接"
            />
            <div class="modal-actions">
              <button type="button" class="btn ghost" id="edit-source-cancel">取消</button>
              <button type="submit" class="btn primary">保存</button>
            </div>
          </form>
        </div>
      </div>

      <div id="toast" class="toast hidden"></div>
      <div id="loading" class="loading hidden">
        <div class="loading-panel">
          <div class="loading-text">加载中...</div>
          <button id="cancel-loading-btn" class="btn ghost">停止刷新</button>
        </div>
      </div>
    </div>

    <script type="module" src="./newtab.js"></script>
  </body>
</html>


